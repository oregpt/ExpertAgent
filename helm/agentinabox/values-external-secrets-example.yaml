# Example: Using External Secrets Operator with AWS Secrets Manager
# This file is SAFE to commit to git - no actual secrets here!
#
# Prerequisites:
# 1. Install External Secrets Operator in your cluster:
#    helm repo add external-secrets https://charts.external-secrets.io
#    helm install external-secrets external-secrets/external-secrets -n external-secrets --create-namespace
#
# 2. Create a ClusterSecretStore for AWS:
#    apiVersion: external-secrets.io/v1beta1
#    kind: ClusterSecretStore
#    metadata:
#      name: aws-secrets-manager
#    spec:
#      provider:
#        aws:
#          service: SecretsManager
#          region: us-east-1
#          auth:
#            jwt:
#              serviceAccountRef:
#                name: external-secrets-sa
#                namespace: external-secrets
#
# 3. Store your secrets in AWS Secrets Manager with this structure:
#    Secret Name: agentinabox/production
#    Secret Value (JSON):
#    {
#      "db_host": "your-db.xxxxx.us-east-1.rds.amazonaws.com",
#      "db_port": "5432",
#      "db_name": "agentinabox",
#      "db_user": "dbadmin",
#      "db_password": "your-secure-password",
#      "anthropic_api_key": "sk-ant-xxxxx",
#      "openai_api_key": "sk-xxxxx",
#      "license_secret": "agenticledger-prod-secret-2024",
#      "license_key": "eyJhbGciOiJIUzI1NiIs..."
#    }
#
# 4. Deploy with: helm install agentinabox ./helm/agentinabox -f values-external-secrets-example.yaml

replicaCount: 2

image:
  repository: your-registry.com/agentinabox
  pullPolicy: Always
  tag: "1.0.0"

ingress:
  enabled: true
  className: nginx
  annotations:
    cert-manager.io/cluster-issuer: letsencrypt-prod
  hosts:
    - host: ai.yourcompany.com
      paths:
        - path: /
          pathType: Prefix
  tls:
    - secretName: agentinabox-tls
      hosts:
        - ai.yourcompany.com

resources:
  limits:
    cpu: 2000m
    memory: 2048Mi
  requests:
    cpu: 500m
    memory: 1024Mi

autoscaling:
  enabled: true
  minReplicas: 2
  maxReplicas: 10

persistence:
  enabled: true
  storageClass: "gp3"
  size: 20Gi

config:
  nodeEnv: production
  port: 4000
  defaultModel: "claude-sonnet-4-20250514"
  features:
    multiAgent: true
    multimodal: true
    mcpHub: true
    customBranding: true

# External Secrets - pulls from AWS Secrets Manager
externalSecrets:
  enabled: true
  refreshInterval: "1h"
  dbSslMode: "require"

  secretStoreRef:
    name: "aws-secrets-manager"
    kind: "ClusterSecretStore"

  remoteRef:
    # Path to your secret in AWS Secrets Manager
    key: "agentinabox/production"

    # Field names in your AWS secret (customize if different)
    properties:
      dbHost: "db_host"
      dbPort: "db_port"
      dbName: "db_name"
      dbUser: "db_user"
      dbPassword: "db_password"
      anthropicApiKey: "anthropic_api_key"
      openaiApiKey: "openai_api_key"
      licenseSecret: "license_secret"
      licenseKey: "license_key"
      # xaiApiKey: "xai_api_key"      # Uncomment if using
      # geminiApiKey: "gemini_api_key" # Uncomment if using

# No secrets in this file! Everything comes from AWS Secrets Manager
# This file is safe to commit to your git repository
